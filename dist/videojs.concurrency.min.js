/*!
 * videojs-concurrency v1.0.0
 * 
 * @author: Carey Hinoki <carey.hinoki@gmail.com> (http://www.careyhinoki.me/)
 * @date: 2015-10-01
 */
!function(t){function e(r){if(o[r])return o[r].exports;var n=o[r]={exports:{},id:r,loaded:!1};return t[r].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}o(1),o(2);var n=o(3),i=r(n),s=o(4),a=r(s),u={init:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o={idle_delay:18e5,poll_delay:2e4,error:Function.prototype,method:"GET",success:Function.prototype};this.options=i["default"]({},o,e),this.idle_timeout_id=null,this.poll_timeout_id=null,this.debug=e.debug||!1,t.on("ended",this.onEnded.bind(this)),t.on("pause",this.onPause.bind(this)),t.on("play",this.onPlay.bind(this))},error:function(t){for(var e=arguments.length,o=Array(e>1?e-1:0),r=1;e>r;r++)o[r-1]=arguments[r];o.length>0?console.error(t,o):console.error(t)},log:function(t){if(this.debug===!0){for(var e=arguments.length,o=Array(e>1?e-1:0),r=1;e>r;r++)o[r-1]=arguments[r];o.length>0?console.log(t,o):console.log(t)}},onEnded:function(t){this.log("ended"),this.log("poll: reset"),this.log("poll: stopped"),clearTimeout(this.idle_timeout_id),clearTimeout(this.poll_timeout_id)},onPause:function(t){var e=this;this.log("pause"),this.log("poll: stopping in "+this.options.idle_delay+"ms"),this.idle_timeout_id=setTimeout(function(){e.log("poll: reset"),e.log("poll: stopped"),clearTimeout(e.poll_timeout_id)},this.options.idle_delay)},onPlay:function(t){this.log("play"),clearTimeout(this.idle_timeout_id),clearTimeout(this.poll_timeout_id),this.log("poll: reset"),this.log("poll: running every "+this.options.poll_delay+"ms"),this.poll()},poll:function(){var t=this,e=a["default"].buildUrl(this.options.url,this.options),o=a["default"].buildOptions(this.options);this.log("poll: "+e),fetch(e,o).then(function(t){return t.json()}).then(function(e){t.poll_timeout_id=setTimeout(function(){t.options.success.apply(t,[e])},t.options.poll_delay)})["catch"](function(e){t.error(e),t.options.error.apply(t,[e])})}};videojs.plugin("concurrency",function(t){u.init(this,t)})},function(t,e){!function(t){"use strict";t.console=t.console||{};for(var e,o,r=t.console,n={},i=function(){},s="memory".split(","),a="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");e=s.pop();)r[e]||(r[e]=n);for(;o=a.pop();)r[o]||(r[o]=i)}("undefined"==typeof window?this:window)},function(t,e){!function(){"use strict";function t(t){if("string"!=typeof t&&(t=t.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function e(t){return"string"!=typeof t&&(t=t.toString()),t}function o(t){this.map={},t instanceof o?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function r(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function n(t){return new Promise(function(e,o){t.onload=function(){e(t.result)},t.onerror=function(){o(t.error)}})}function i(t){var e=new FileReader;return e.readAsArrayBuffer(t),n(e)}function s(t){var e=new FileReader;return e.readAsText(t),n(e)}function a(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(f.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(f.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else{if(t)throw new Error("unsupported BodyInit type");this._bodyText=""}},f.blob?(this.blob=function(){var t=r(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(i)},this.text=function(){var t=r(this);if(t)return t;if(this._bodyBlob)return s(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=r(this);return t?t:Promise.resolve(this._bodyText)},f.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function u(t){var e=t.toUpperCase();return c.indexOf(e)>-1?e:t}function l(t,e){if(e=e||{},this.url=t,this.credentials=e.credentials||"omit",this.headers=new o(e.headers),this.method=u(e.method||"GET"),this.mode=e.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&e.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(e.body)}function d(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var o=t.split("="),r=o.shift().replace(/\+/g," "),n=o.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(n))}}),e}function p(t){var e=new o,r=t.getAllResponseHeaders().trim().split("\n");return r.forEach(function(t){var o=t.trim().split(":"),r=o.shift().trim(),n=o.join(":").trim();e.append(r,n)}),e}function h(t,e){e||(e={}),this._initBody(t),this.type="default",this.url=null,this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof o?e.headers:new o(e.headers),this.url=e.url||""}if(!self.fetch){o.prototype.append=function(o,r){o=t(o),r=e(r);var n=this.map[o];n||(n=[],this.map[o]=n),n.push(r)},o.prototype["delete"]=function(e){delete this.map[t(e)]},o.prototype.get=function(e){var o=this.map[t(e)];return o?o[0]:null},o.prototype.getAll=function(e){return this.map[t(e)]||[]},o.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},o.prototype.set=function(o,r){this.map[t(o)]=[e(r)]},o.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(o){this.map[o].forEach(function(r){t.call(e,r,o,this)},this)},this)};var f={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in self},c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];a.call(l.prototype),a.call(h.prototype),self.Headers=o,self.Request=l,self.Response=h,self.fetch=function(t,e){var o;return o=l.prototype.isPrototypeOf(t)&&!e?t:new l(t,e),new Promise(function(t,e){function r(){return"responseURL"in n?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):void 0}var n=new XMLHttpRequest;n.onload=function(){var o=1223===n.status?204:n.status;if(100>o||o>599)return void e(new TypeError("Network request failed"));var i={status:o,statusText:n.statusText,headers:p(n),url:r()},s="response"in n?n.response:n.responseText;t(new h(s,i))},n.onerror=function(){e(new TypeError("Network request failed"))},n.open(o.method,o.url,!0),"include"===o.credentials&&(n.withCredentials=!0),"responseType"in n&&f.blob&&(n.responseType="blob"),o.headers.forEach(function(t,e){n.setRequestHeader(e,t)}),n.send("undefined"==typeof o._bodyInit?null:o._bodyInit)})},self.fetch.polyfill=!0}}()},function(t,e){"use strict";function o(t){var e,o,r;for(o=1;o<arguments.length;o++){e=arguments[o];for(r in e)e.hasOwnProperty(r)&&"undefined"!=typeof e[r]&&(t[r]=e[r])}return t}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o,t.exports=e["default"]},function(t,e,o){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){var o=[],r=!0,n=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(o.push(s.value),!e||o.length!==e);r=!0);}catch(u){n=!0,i=u}finally{try{!r&&a["return"]&&a["return"]()}finally{if(n)throw i}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=o(3),s=r(i),a={buildUri:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(0===Object.keys(e).length)return t;var o=0,r=t+"?";for(var n in e)e.hasOwnProperty(n)&&(o++&&(r+="&"),r+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return r},buildUrl:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];if(new RegExp("^GET$","i").test(e.method)===!1)return t;var o=this.parseUrl(t,e),r=o.data,n=o.host;return this.buildUri(n,r)},buildOptions:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e={};return new RegExp("^POST$","i").test(t.method)&&(e.body=JSON.stringify(t.data),e.method=t.method,e.headers=s["default"]({},{Accept:"application/json","Content-Type":"application/json"},t.headers)),e},parseUrl:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o={},r=void 0,i=void 0,a=document.createElement("a");if(a.href=t,r=a.protocol+"//"+a.host+a.pathname,""===a.search)return{data:{},host:r};i=a.search.replace(/^\?/,"").split("&");for(var u=0,l=i.length;l>u;u++){var d=i[u].split("="),p=n(d,2),h=p[0],f=p[1];o[h]=f}return{data:s["default"](o,e.data),host:r}}};e["default"]=a,t.exports=e["default"]}]);